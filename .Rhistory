results_mkb3 <- empty
results_mkb3["AIC", ] <- new_formula_gd(select_gamlss2(f4, data = df, family = SHASH, criterion = "AIC"))
results_mkb3["BIC", ]  <- new_formula_gd(select_gamlss2(f4, data = df, family = SHASH, criterion = "BIC"))
results_mkb3["GCV", ] <- new_formula_gd(select_gamlss2(f4, data = df, family = SHASH, criterion = "GCV"))
# plot results
tth = ttheme("default")
p1 <- ggtexttable(results_mdb25, theme =tth )
p2 <- ggtexttable(results_mkb25, theme =tth )
p3 <- ggtexttable(results_mdb3, theme = tth)
p4 <- ggtexttable(results_mkb3, theme = tth)
ggarrange(p1, p3, p2, p4,
ncol = 1, nrow = 4,
labels = c("PRE: MD b2.5",
"POST: MD b3",
"PRE: MK b2.5",
"POST: MK b3")) # Optional tags
# MK b2.5
f2 <- md_maxb2.5 ~ pb(age, by=sex, k=5) + pb(volume, k=5) + sex + s(dataset, bs='re')+s(scanner, bs='re')+s(TE, bs='re') +s(voxelsize, bs='re')+s(TR, bs='re') | s(dataset, bs='re')+s(scanner, bs='re')+s(TE, bs='re') +s(voxelsize, bs='re')+s(TR, bs='re')
results_mkb25 <- empty
results_mkb25["AIC", ] <- new_formula_gd(select_gamlss2(f2, data = df, family = SHASH, criterion = "AIC"))
results_mkb25["BIC", ] <- new_formula_gd(select_gamlss2(f2, data = df, family = SHASH, criterion = "BIC"))
results_mkb25["GCV", ]<- new_formula_gd(select_gamlss2(f2, data = df, family = SHASH, criterion = "GCV"))
# plot results
tth = ttheme("default")
p1 <- ggtexttable(results_mdb25, theme =tth )
p2 <- ggtexttable(results_mkb25, theme =tth )
p3 <- ggtexttable(results_mdb3, theme = tth)
p4 <- ggtexttable(results_mkb3, theme = tth)
ggarrange(p1, p3, p2, p4,
ncol = 1, nrow = 4,
labels = c("PRE: MD b2.5",
"POST: MD b3",
"PRE: MK b2.5",
"POST: MK b3")) # Optional tags
# MK b2.5
f2 <- mk_maxb2.5 ~ pb(age, by=sex, k=5) + pb(volume, k=5) + sex + s(dataset, bs='re')+s(scanner, bs='re')+s(TE, bs='re') +s(voxelsize, bs='re')+s(TR, bs='re') | s(dataset, bs='re')+s(scanner, bs='re')+s(TE, bs='re') +s(voxelsize, bs='re')+s(TR, bs='re')
results_mkb25 <- empty
results_mkb25["AIC", ] <- new_formula_gd(select_gamlss2(f2, data = df, family = SHASH, criterion = "AIC"))
results_mkb25["BIC", ] <- new_formula_gd(select_gamlss2(f2, data = df, family = SHASH, criterion = "BIC"))
results_mkb25["GCV", ]<- new_formula_gd(select_gamlss2(f2, data = df, family = SHASH, criterion = "GCV"))
# MD b3
f3 <- md_maxb3 ~ pb(age, by=sex, k=5) + pb(volume, k=5) + sex + s(dataset, bs='re')+s(scanner, bs='re')+s(TE, bs='re') +s(voxelsize, bs='re')+s(TR, bs='re') | s(dataset, bs='re')+s(scanner, bs='re')+s(TE, bs='re') +s(voxelsize, bs='re')+s(TR, bs='re')
results_mdb3 <- empty
results_mdb3["AIC", ]  <- new_formula_gd(select_gamlss2(f3, data = df, family = SHASH, criterion = "AIC"))
results_mdb3["BIC", ] <- new_formula_gd(select_gamlss2(f3, data = df, family = SHASH, criterion = "BIC"))
results_mdb3["GCV", ]  <- new_formula_gd(select_gamlss2(f3, data = df, family = SHASH, criterion = "GCV"))
# plot results
tth = ttheme("default")
p1 <- ggtexttable(results_mdb25, theme =tth )
p2 <- ggtexttable(results_mkb25, theme =tth )
p3 <- ggtexttable(results_mdb3, theme = tth)
p4 <- ggtexttable(results_mkb3, theme = tth)
ggarrange(p1, p3, p2, p4,
ncol = 1, nrow = 4,
labels = c("PRE: MD b2.5",
"POST: MD b3",
"PRE: MK b2.5",
"POST: MK b3")) # Optional tags
# ---------------------------------------------------------------------------
# Plot best model corrected data
f_md <- md_maxb3 ~ pb(age, by=sex, k=5) + pb(volume, k=5) + sex + s(dataset, bs='re') + s(scanner, bs='re') | s(dataset, bs='re')+s(scanner, bs='re')
best_md_model <- gamlss2(f_md, data = df, family = SHASH)
# predict removing scanner and dataset effects
df$md_maxb3_harm <- predict(best_md_model, newdata = df %>%
mutate(scanner = levels(df$scanner)[1],
dataset = levels(df$dataset)[1]))
df %>%
mutate(scanner = levels(df$scanner)[1],
dataset = levels(df$dataset)[1])
levels(df$scanner)[1]
levels(df$dataset)[1]
levels(df$dataset)
# predict removing scanner and dataset effects
df$md_maxb3_harm <- predict(best_md_model, newdata = df %>%
mutate(scanner = levels(df$scanner)[1],
dataset = levels(df$dataset)[4]),
what = "mu")
# predict removing scanner and dataset effects
df$md_maxb3_harm <- predict(best_md_model, newdata = df %>%
mutate(scanner = levels(df$scanner)[1],
dataset = levels(df$dataset)[4]))
# predict removing scanner and dataset effects
df_new <- df %>%
mutate(scanner = levels(df$scanner)[1],
dataset = levels(df$dataset)[4])
df_new
df$md_maxb3_harm <- predict(best_md_model, newdata = df_new, type = "response")
# predict removing scanner and dataset effects
df_new <- df
df_new$scanner <- levels(df$scanner)[1]
df_new$dataset <- levels(df$dataset)[4]
levels(df_new$scanner)
level(df_new$scanner)
df <- read.csv("~/urblauna/tpavan1/post_recon_LSP/covar_with_scanners_info_with_avgs_for_harm_in_R.csv")
df$age <- as.numeric(df$age)
df$volume <- df$total_brain - df$total_vent
df$scanner <- as.factor(df$scanner)
df$sex <- as.factor(df$sex)
df$dataset <- as.factor(df$dataset)
df$TE <- as.numeric(df$TE)
df$voxelsize <- as.numeric(df$voxelsize)
df$TR <- as.numeric(df$TR)
# predict removing scanner and dataset effects
df_new <- df
levels(df$scanner)
df_new$scanner <- levels(df$scanner)[1]
levels(df$scanner)
df_new$scanner
df_new$dataset <- levels(df$dataset)[4]
df$md_maxb3_harm <- predict(best_md_model, newdata = df_new, type = "response")
levels(df$dataset)
df_new$dataset
levels(df_new$scanner)
df_new <- df
df_new$scanner <- factor(levels(df$scanner)[1], levels=levels(df$scanner))
df_new$dataset <- factor(levels(df$dataset)[4], levels=levels(df$dataset))
df$md_maxb3_harm <- predict(best_md_model, newdata = df_new, type = "response")
df$md_maxb3_harm
df$md_maxb3_harm <- predict(best_md_model, newdata = df_new, type = "mu")
df$md_maxb3_harm <- predict(best_md_model, newdata = df_new, type = "response")
plot_md_harm <- ggplot(df, aes(x = age, y = md_maxb3_harm, color=scanner)) +
geom_point() +
geom_smooth(formula=y ~ poly(x, 2), se=FALSE) +
labs(title = "HARM: MD vs Age by Scanner", x = "Age", y = "Mean Diffusivity (MD) HARMONIZED") +
theme_minimal() +
theme(legend.position = "none")
plot_md_harm
plot_md_harm <- ggplot(df, aes(x = age, y = md_maxb3_harm, color=scanner)) +
geom_point() +
#geom_smooth(formula=y ~ poly(x, 2), se=FALSE) +
labs(title = "HARM: MD vs Age by Scanner", x = "Age", y = "Mean Diffusivity (MD) HARMONIZED") +
theme_minimal() +
theme(legend.position = "none")
plot_md_harm
levels(df$scanner)
df_new <- df
df_new$scanner <- factor(levels(df$scanner)[2], levels=levels(df$scanner))
df_new$dataset <- factor(levels(df$dataset)[2], levels=levels(df$dataset))
df$md_maxb3_harm <- predict(best_md_model, newdata = df_new, type = "response")
plot_md_harm <- ggplot(df, aes(x = age, y = md_maxb3_harm, color=scanner)) +
geom_point() +
#geom_smooth(formula=y ~ poly(x, 2), se=FALSE) +
labs(title = "HARM: MD vs Age by Scanner", x = "Age", y = "Mean Diffusivity (MD) HARMONIZED") +
theme_minimal() +
theme(legend.position = "none")
plot_md_harm
# Plot best model corrected data
# MD
f_md <- md_maxb3 ~ pb(age, by=sex, k=5) + pb(volume, k=5) + sex + s(dataset, bs='re') + s(scanner, bs='re') | s(dataset, bs='re') + s(scanner, bs='re')
best_md_model <- gamlss2(f_md, data = df, family = SHASH)
# predict removing scanner and dataset effects
df_new <- df
df_new$scanner <- factor(levels(df$scanner)[1], levels=levels(df$scanner))
df_new$dataset <- factor(levels(df$dataset)[4], levels=levels(df$dataset))
df$md_maxb3_harm <- predict(best_md_model, newdata = df_new, type = "response")
plot_md_harm <- ggplot(df, aes(x = age, y = md_maxb3_harm, color=dataset)) +
geom_point() +
geom_smooth(formula=y ~ poly(x, 2), se=FALSE) +
labs(title = "HARM: MD vs Age by Scanner", x = "Age", y = "Mean Diffusivity (MD) HARMONIZED") +
theme_minimal() +
theme(legend.position = "none")
# MK
f_mk <- mk_maxb3 ~ pb(age, by=sex, k=5) + pb(volume, k=5) + sex + s(dataset, bs='re') + s(scanner, bs='re') | s(dataset, bs='re') + s(scanner, bs='re')
best_md_model <- gamlss2(f_md, data = df, family = SHASH)
# predict removing scanner and dataset effects
df_new <- df
df_new$scanner <- factor(levels(df$scanner)[1], levels=levels(df$scanner))
df_new$dataset <- factor(levels(df$dataset)[4], levels=levels(df$dataset))
df$mk_maxb3_harm <- predict(best_mk_model, newdata = df_new, type = "response")
f_mk <- mk_maxb3 ~ pb(age, by=sex, k=5) + pb(volume, k=5) + sex + s(dataset, bs='re') + s(scanner, bs='re') | s(dataset, bs='re') + s(scanner, bs='re')
best_mk_model <- gamlss2(f_mk, data = df, family = SHASH)
# predict removing scanner and dataset effects
df_new <- df
df_new$scanner <- factor(levels(df$scanner)[1], levels=levels(df$scanner))
df_new$dataset <- factor(levels(df$dataset)[4], levels=levels(df$dataset))
df$mk_maxb3_harm <- predict(best_mk_model, newdata = df_new, type = "response")
plot_mk_harm <- ggplot(df, aes(x = age, y = mk_maxb3_harm, color=dataset)) +
geom_point() +
geom_smooth(formula=y ~ poly(x, 2), se=FALSE) +
labs(title = "HARM: MK vs Age by Scanner", x = "Age", y = "Mean Kurtosis (MK) HARMONIZED") +
theme_minimal() +
theme(legend.position = "none")
plot_mk_harm
# plot the two together as subplots
ggarrange(mdb3post, mkb3post, plot_md_harm, plot_mk_harm,  ncol = 2, nrow=2, common.legend = TRUE, legend = "right")
df <- read.csv("~/urblauna/tpavan1/post_recon_LSP/covar_with_scanners_info_with_avgs_for_harm_in_R.csv")
df$age <- as.numeric(df$age)
df$volume <- df$total_brain - df$total_vent
df$scanner <- as.factor(df$scanner)
df$sex <- as.factor(df$sex)
df$dataset <- as.factor(df$dataset)
df$TE <- as.numeric(df$TE)
df$voxelsize <- as.numeric(df$voxelsize)
df$TR <- as.numeric(df$TR)
# Plot mk vs age for each scanner, no legend
mdb2pre <-  ggplot(df, aes(x = age, y = md_maxb2.5, color=scanner)) +
geom_point() +
geom_smooth(formula=y ~ poly(x, 2), se=FALSE) +
labs(title = "PRE: MD vs Age by Scanner", x = "Age", y = "Mean Diffusivity (MD)") +
theme_minimal() +
theme(legend.position = "none")
mkb2pre <-  ggplot(df, aes(x = age, y = mk_maxb2.5, color=scanner)) +
geom_point() +
geom_smooth(formula=y ~ poly(x, 2), se=FALSE) +
labs(title = "PRE: MK vs Age by Scanner", x = "Age", y = "Mean Kurtosis (MK)") +
theme_minimal() +
theme(legend.position = "none")
mdb3post <-  ggplot(df, aes(x = age, y = md_maxb3, color=scanner)) +
geom_point() +
geom_smooth(formula=y ~ poly(x, 2), se=FALSE) +
labs(title = "POST: MD vs Age by Scanner", x = "Age", y = "Mean Diffusivity (MD)") +
theme_minimal() +
theme(legend.position = "none")
mkb3post <-  ggplot(df, aes(x = age, y = mk_maxb3, color=scanner)) +
geom_point() +
geom_smooth(formula=y ~ poly(x, 2), se=FALSE) +
labs(title = "POST: MK vs Age by Scanner", x = "Age", y = "Mean Kurtosis (MK)") +
theme_minimal() + theme(legend.position = "bottom")
# plot the two together as subplots
ggarrange(mdb3post, mkb3post, plot_md_harm, plot_mk_harm,  ncol = 2, nrow=2, common.legend = TRUE, legend = "right")
### references:
mdb3post <-  ggplot(df, aes(x = age, y = md_maxb3, color=dataset)) +
geom_point() +
geom_smooth(formula=y ~ poly(x, 2), se=FALSE) +
labs(title = "POST: MD vs Age by Dataset", x = "Age", y = "Mean Diffusivity (MD)") +
theme_minimal() +
theme(legend.position = "none")
mkb3post <-  ggplot(df, aes(x = age, y = mk_maxb3, color=dataset)) +
geom_point() +
geom_smooth(formula=y ~ poly(x, 2), se=FALSE) +
labs(title = "POST: MK vs Age by Dataset", x = "Age", y = "Mean Kurtosis (MK)") +
theme_minimal() + theme(legend.position = "bottom")
# plot the two together as subplots
ggarrange(mdb3post, plot_md_harm, mkb3post, plot_mk_harm,  ncol = 2, nrow=2, common.legend = TRUE, legend = "right")
f_md <- md_maxb3 ~ pb(age, by=sex, k=5) + pb(volume, k=5) + sex + s(dataset, bs='re') + s(scanner, bs='re') #| s(dataset, bs='re') + s(scanner, bs='re')
best_md_model <- gamlss2(f_md, data = df, family = SHASH)
# predict removing scanner and dataset effects
df_new <- df
df_new$scanner <- factor(levels(df$scanner)[1], levels=levels(df$scanner))
df_new$dataset <- factor(levels(df$dataset)[4], levels=levels(df$dataset))
df$md_maxb3_harm <- predict(best_md_model, newdata = df_new, type = "response")
plot_md_harm <- ggplot(df, aes(x = age, y = md_maxb3_harm, color=dataset)) +
geom_point() +
geom_smooth(formula=y ~ poly(x, 2), se=FALSE) +
labs(title = "HARM: MD vs Age by Dataset", x = "Age", y = "Mean Diffusivity (MD) HARMONIZED") +
theme_minimal() +
theme(legend.position = "none")
# MK
f_mk <- mk_maxb3 ~ pb(age, by=sex, k=5) + pb(volume, k=5) + sex + s(dataset, bs='re') + s(scanner, bs='re') #| s(dataset, bs='re') + s(scanner, bs='re')
best_mk_model <- gamlss2(f_mk, data = df, family = SHASH)
# predict removing scanner and dataset effects
df_new <- df
df_new$scanner <- factor(levels(df$scanner)[1], levels=levels(df$scanner))
df_new$dataset <- factor(levels(df$dataset)[4], levels=levels(df$dataset))
df$mk_maxb3_harm <- predict(best_mk_model, newdata = df_new, type = "response")
plot_mk_harm <- ggplot(df, aes(x = age, y = mk_maxb3_harm, color=dataset)) +
geom_point() +
geom_smooth(formula=y ~ poly(x, 2), se=FALSE) +
labs(title = "HARM: MK vs Age by Dataset", x = "Age", y = "Mean Kurtosis (MK) HARMONIZED") +
theme_minimal() +
theme(legend.position = "none")
### references:
mdb3post <-  ggplot(df, aes(x = age, y = md_maxb3, color=dataset)) +
geom_point() +
geom_smooth(formula=y ~ poly(x, 2), se=FALSE) +
labs(title = "POST: MD vs Age by Dataset", x = "Age", y = "Mean Diffusivity (MD)") +
theme_minimal() +
theme(legend.position = "none")
mkb3post <-  ggplot(df, aes(x = age, y = mk_maxb3, color=dataset)) +
geom_point() +
geom_smooth(formula=y ~ poly(x, 2), se=FALSE) +
labs(title = "POST: MK vs Age by Dataset", x = "Age", y = "Mean Kurtosis (MK)") +
theme_minimal() + theme(legend.position = "bottom")
# plot the two together as subplots
ggarrange(mdb3post, plot_md_harm, mkb3post, plot_mk_harm,  ncol = 2, nrow=2, common.legend = TRUE, legend = "right")
ggplot(df, aes(x = age, y = md_maxb3_harm, color=sex)) +
geom_point() +
geom_smooth(formula=y ~ poly(x, 2), se=FALSE) +
labs(title = "HARM: MD vs Age by Dataset", x = "Age", y = "Mean Diffusivity (MD) HARMONIZED") +
theme_minimal() +
theme(legend.position = "none")
ggplot(df, aes(x = age, y = md_maxb3_harm, color=sex)) +
geom_point() +
geom_smooth(formula=y ~ poly(x, 2), se=FALSE) +
labs(title = "HARM: MD vs Age by SEX", x = "Age", y = "Mean Diffusivity (MD) HARMONIZED") +
theme_minimal() +
theme(legend.position = "none")
ggplot(df, aes(x = age, y = md_maxb3_harm, color=sex)) +
geom_point() +
geom_smooth(se=FALSE) +
labs(title = "HARM: MD vs Age by SEX", x = "Age", y = "Mean Diffusivity (MD) HARMONIZED") +
theme_minimal() +
theme(legend.position = "none")
ggarrange(mdb3post, plot_md_harm, ncol = 2, nrow=1, common.legend = TRUE, legend = "right")
ggarrange(mkb3post, plot_mk_harm,  ncol = 2, nrow=1, common.legend = TRUE, legend = "right")
# ---------------------------------------------------------------------------
# Plot MD vs scanner and MK vs scanner colored by dataset
ggplot(df, aes(x = scanner, y = md_maxb2.5, color=dataset)) +
geom_boxplot() +
labs(title = "PRE: MD by Scanner and Dataset", x = "Scanner", y = "Mean Diffusivity (MD)") +
theme_minimal() +
theme(legend.position = "bottom")
# Plot MD vs scanner and MK vs scanner colored by dataset
md_box25 <- ggplot(df, aes(x = scanner, y = md_maxb2.5, color=dataset)) +
geom_boxplot() +
labs(title = "PRE: MD by Scanner and Dataset", x = "Scanner", y = "Mean Diffusivity (MD)") +
theme_minimal() +
theme(legend.position = "bottom")
mk_box25 <- ggplot(df, aes(x = scanner, y = mk_maxb2.5, color=dataset)) +
geom_boxplot() +
labs(title = "PRE: MK by Scanner and Dataset", x = "Scanner", y = "Mean Kurtosis (MK)") +
theme_minimal() +
theme(legend.position = "bottom")
md_box3 <- ggplot(df, aes(x = scanner, y = md_maxb2.5, color=dataset)) +
geom_boxplot() +
labs(title = "POST: MD by Scanner and Dataset", x = "Scanner", y = "Mean Diffusivity (MD)") +
theme_minimal() +
theme(legend.position = "bottom")
mk_box3 <- ggplot(df, aes(x = scanner, y = mk_maxb2.5, color=dataset)) +
geom_boxplot() +
labs(title = "POST: MK by Scanner and Dataset", x = "Scanner", y = "Mean Kurtosis (MK)") +
theme_minimal() +
theme(legend.position = "bottom")
# plot the two together as subplots
ggarrange(md_box25, md_box3, mk_box25, mk_box3, ncol = 2, nrow=2, common.legend = TRUE, legend = "right")
# Plot MD vs scanner and MK vs scanner colored by dataset
md_box25 <- ggplot(df, aes(x = scanner, y = md_maxb2.5, color=dataset)) +
geom_boxplot() +
labs(title = "PRE: MD by Scanner and Dataset", x = "Scanner", y = "Mean Diffusivity (MD)") +
theme(legend.position = "bottom")
mk_box25 <- ggplot(df, aes(x = scanner, y = mk_maxb2.5, color=dataset)) +
geom_boxplot() +
labs(title = "PRE: MK by Scanner and Dataset", x = "Scanner", y = "Mean Kurtosis (MK)") +
theme(legend.position = "bottom")
md_box3 <- ggplot(df, aes(x = scanner, y = md_maxb2.5, color=dataset)) +
geom_boxplot() +
labs(title = "POST: MD by Scanner and Dataset", x = "Scanner", y = "Mean Diffusivity (MD)") +
theme(legend.position = "bottom")
mk_box3 <- ggplot(df, aes(x = scanner, y = mk_maxb2.5, color=dataset)) +
geom_boxplot() +
labs(title = "POST: MK by Scanner and Dataset", x = "Scanner", y = "Mean Kurtosis (MK)") +
theme(legend.position = "bottom")
# plot the two together as subplots
ggarrange(md_box25, md_box3, mk_box25, mk_box3, ncol = 2, nrow=2, common.legend = TRUE, legend = "right")
# Plot MD vs scanner and MK vs scanner colored by dataset
md_box25 <- ggplot(df, aes(x = scanner, y = md_maxb2.5, color=dataset)) +
geom_boxplot() +
labs(title = "PRE: MD by Scanner and Dataset", x = "Scanner", y = "Mean Diffusivity (MD)") +
+ theme_linedraw()
# Plot MD vs scanner and MK vs scanner colored by dataset
md_box25 <- ggplot(df, aes(x = scanner, y = md_maxb2.5, color=dataset)) +
geom_boxplot() +
labs(title = "PRE: MD by Scanner and Dataset", x = "Scanner", y = "Mean Diffusivity (MD)") +
+ theme_linedraw()+
theme(legend.position = "bottom")
md_box25 <- ggplot(df, aes(x = scanner, y = md_maxb2.5, color=dataset)) +
geom_boxplot() +
labs(title = "PRE: MD by Scanner and Dataset", x = "Scanner", y = "Mean Diffusivity (MD)") +
theme_linedraw() +
theme(legend.position = "bottom")
mk_box25 <- ggplot(df, aes(x = scanner, y = mk_maxb2.5, color=dataset)) +
geom_boxplot() +
labs(title = "PRE: MK by Scanner and Dataset", x = "Scanner", y = "Mean Kurtosis (MK)") +
theme_light()+
theme(legend.position = "bottom")
md_box3 <- ggplot(df, aes(x = scanner, y = md_maxb2.5, color=dataset)) +
geom_boxplot() +
labs(title = "POST: MD by Scanner and Dataset", x = "Scanner", y = "Mean Diffusivity (MD)") +
theme(legend.position = "bottom")
mk_box3 <- ggplot(df, aes(x = scanner, y = mk_maxb2.5, color=dataset)) +
geom_boxplot() +
labs(title = "POST: MK by Scanner and Dataset", x = "Scanner", y = "Mean Kurtosis (MK)") +
theme(legend.position = "bottom")
# plot the two together as subplots
ggarrange(md_box25, md_box3, mk_box25, mk_box3, ncol = 2, nrow=2, common.legend = TRUE, legend = "right")
# ---------------------------------------------------------------------------
# Plot MD vs scanner and MK vs scanner colored by dataset
md_box25 <- ggplot(df, aes(x = scanner, y = md_maxb2.5, fill=dataset)) +
geom_boxplot() +
labs(title = "PRE: MD by Scanner and Dataset", x = "Scanner", y = "Mean Diffusivity (MD)") +
theme_linedraw() +
theme(legend.position = "bottom")
mk_box25 <- ggplot(df, aes(x = scanner, y = mk_maxb2.5, fill=dataset)) +
geom_boxplot() +
labs(title = "PRE: MK by Scanner and Dataset", x = "Scanner", y = "Mean Kurtosis (MK)") +
theme_linedraw() +
theme(legend.position = "bottom")
md_box3 <- ggplot(df, aes(x = scanner, y = md_maxb2.5, fill=dataset)) +
geom_boxplot() +
labs(title = "POST: MD by Scanner and Dataset", x = "Scanner", y = "Mean Diffusivity (MD)") +
theme_linedraw() +
theme(legend.position = "bottom")
mk_box3 <- ggplot(df, aes(x = scanner, y = mk_maxb2.5, fill=dataset)) +
geom_boxplot() +
labs(title = "POST: MK by Scanner and Dataset", x = "Scanner", y = "Mean Kurtosis (MK)") +
theme_linedraw() +
theme(legend.position = "bottom")
# plot the two together as subplots
ggarrange(md_box25, md_box3, mk_box25, mk_box3, ncol = 2, nrow=2, common.legend = TRUE, legend = "right")
md_box25 <- ggplot(df, aes(x = scanner, y = md_maxb2.5, fill=dataset)) +
geom_boxplot() +
labs(title = "PRE: MD by Scanner and Dataset", x = "Scanner", y = "Mean Diffusivity (MD)") +
theme_light() +
theme(legend.position = "bottom")
mk_box25 <- ggplot(df, aes(x = scanner, y = mk_maxb2.5, fill=dataset)) +
geom_boxplot() +
labs(title = "PRE: MK by Scanner and Dataset", x = "Scanner", y = "Mean Kurtosis (MK)") +
theme_light() +
theme(legend.position = "bottom")
md_box3 <- ggplot(df, aes(x = scanner, y = md_maxb3, fill=dataset)) +
geom_boxplot() +
labs(title = "POST: MD by Scanner and Dataset", x = "Scanner", y = "Mean Diffusivity (MD)") +
theme_light() +
theme(legend.position = "bottom")
mk_box3 <- ggplot(df, aes(x = scanner, y = mk_maxb3, fill=dataset)) +
geom_boxplot() +
labs(title = "POST: MK by Scanner and Dataset", x = "Scanner", y = "Mean Kurtosis (MK)") +
theme_light() +
theme(legend.position = "bottom")
# plot the two together as subplots
ggarrange(md_box25, md_box3, mk_box25, mk_box3, ncol = 2, nrow=2, common.legend = TRUE, legend = "right")
md_box25 <- ggplot(df, aes(x = scanner, y = md_maxb2.5, fill=dataset)) +
geom_boxplot() +
labs(title = "PRE: MD by Scanner and Dataset", x = "Scanner", y = "Mean Diffusivity (MD)") +
theme_light() +
theme(legend.position = "bottom", axis.text.x = element_text(angle = 45, hjust = 1))
mk_box25 <- ggplot(df, aes(x = scanner, y = mk_maxb2.5, fill=dataset)) +
geom_boxplot() +
labs(title = "PRE: MK by Scanner and Dataset", x = "Scanner", y = "Mean Kurtosis (MK)") +
theme_light() +
theme(legend.position = "bottom", axis.text.x = element_text(angle = 45, hjust = 1))
md_box3 <- ggplot(df, aes(x = scanner, y = md_maxb3, fill=dataset)) +
geom_boxplot() +
labs(title = "POST: MD by Scanner and Dataset", x = "Scanner", y = "Mean Diffusivity (MD)") +
theme_light() +
theme(legend.position = "bottom", axis.text.x = element_text(angle = 45, hjust = 1))
mk_box3 <- ggplot(df, aes(x = scanner, y = mk_maxb3, fill=dataset)) +
geom_boxplot() +
labs(title = "POST: MK by Scanner and Dataset", x = "Scanner", y = "Mean Kurtosis (MK)") +
theme_light() +
theme(legend.position = "bottom", axis.text.x = element_text(angle = 45, hjust = 1))
# plot the two together as subplots
ggarrange(md_box25, md_box3, mk_box25, mk_box3, ncol = 2, nrow=2, common.legend = TRUE, legend = "right")
ggplot(df, aes(x = age, y = mk_maxb3_harm, color=sex)) +
geom_point() +
geom_smooth(se=FALSE) +
labs(title = "HARM: MD vs Age by SEX", x = "Age", y = "Mean Diffusivity (MD) HARMONIZED") +
theme_minimal() +
theme(legend.position = "none")
ggplot(df, aes(x = age, y = mk_maxb3_harm, color=sex)) +
geom_point() +
geom_smooth(se=FALSE) +
labs(title = "HARM: MD vs Age by SEX", x = "Age", y = "Mean Kurtosis (MK) HARMONIZED") +
theme_minimal() +
theme(legend.position = "none")
ggplot(df, aes(x = age, y = mk_maxb3_harm, color=sex)) +
geom_point() +
geom_smooth(se=FALSE) +
labs(title = "HARM: MD vs Age by SEX", x = "Age", y = "Mean Kurtosis (MK) HARMONIZED") +
theme_minimal() +
theme()
plot(best_mk_model)
plot(best_mk_model)
plot(best_md_model)
plot(best_md_model)
plot(best_mk_model)
# MK
f_mk <- mk_maxb3 ~ pb(age, by=sex, k=5) + pb(volume, k=5) + sex + s(dataset, bs='re') + s(scanner, bs='re') #| s(dataset, bs='re') + s(scanner, bs='re')
best_mk_model <- gamlss2(f_mk, data = df, family = SHASH)
plot(best_mk_model)
plot(best_md_model)
wormplot(best_md_model)
wp(best_md_model)
wp(best_md_model)
plot.gamlss
plot.gamlss2
?plot.gamlss2
plot(best_md_model, which='qq-resid')
plot(best_mk_model, which='qq-resid')
plot(best_md_model, which='qq-resid')
plot(best_mk_model, which='qq-resid')
?plot.gamlss2
plot(best_md_model, which='hist-resid')
plot(best_mk_model, which='hist-resid')
?plot.gamlss2
plot(best_md_model, which='scatter-resid')
plot(best_mk_model, which='scatter-resid')
plot(best_md_model, which='qq-resid')
plot(best_mk_model, which='qq-resid')
wormplot(best_mk_model)
gamlss::wormplot
gamlss2::wormplot
install.packages("topmodels", repos = "https://zeileis.R-universe.dev")
wormplot(best_mk_model)
library(topmodels)
### references:
mdb3post <-  ggplot(df, aes(x = age, y = md_maxb3, color=dataset)) +
geom_point() +
geom_smooth(se=FALSE) +
labs(title = "POST: MD vs Age by Dataset", x = "Age", y = "Mean Diffusivity (MD)") +
theme_minimal() +
theme(legend.position = "none")
install.packages('colorspace')
library(topmodels)
install.packages("topmodels", repos = "https://zeileis.R-universe.dev")
library(topmodels)
wormplot(best_mk_model)
wormplot(best_md_model)
?plot.gamlss2
plot(best_md_model, which='hist-resid')
plot(best_md_model, which='hist-resid')
plot(best_mk_model, which='hist-resid')
